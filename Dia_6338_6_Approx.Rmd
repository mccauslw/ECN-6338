---
title: "ECN 6338 Cours 6"
subtitle: "Approximation de fonctions"
author: "William McCausland"
date: "`r Sys.Date()`"
output: beamer_presentation
urlcolor: blue
---

## Survol du cours 5

### Approximations locales

- Approximation de Taylor
- Approximation de Padé

### Expansions avec coefficients simples

- Approximation linéaire par morceaux
- Approximations Bernstein, Bernstein itéré
- Approximation Hermite

### Expansions avec projections

- Suites de polynômes orthogonaux

## L'approximation de Taylor

- L'approximation de Taylor utilise l'information locale suivante à un point $x_0$ :
    - la valeur $f(x_0)$ de la fonction à approximer,
    - ses $n$ premières dérivées $f'(x_0), f''(x_0), \ldots, f^{(n)}(x_0)$.
- L'approximation est
\[
  \hat{f}(x) = f(x_0) + \sum_{i=1}^n \frac{(x-x_0)^i}{i!} f^{(i)}(x_0).
\]
- La valeur de $\hat{f}$ et de ses $n$ premières dérivées concordent avec celles de $f$
au point $x_0$.
- L'expansion a $n+1$ paramètres libres à spécifier.
- Peu importe l'ordre $n$, l'approximation est locale.

## L'approximation Padé

- Comme l'approximation de Taylor, une approximation Padé
    - utilise la valeur de $f$ et de ses premières $n$ dérivées à $x_0$,
    - concorde avec $f$ sur ces valeurs à $x_0$,
    - a $n+1$ paramètres libres à spécifier.

- L'approximation est une fonction rationnelle, un ratio de polynômes :
\[
  f(x) \approx r(x) \equiv \frac{p(x)}{q(x)}
  = \frac{p_0 + p_1(x-x_0) + \ldots + p_m(x-x_0)^m}{1 + q_1(x-x_0) + \ldots + q_d(x-x_0)^d},
\]
où $m + d = n$ et souvent $m = d$ ou $m = d+1$.
- La condition $f^i(x_0) = r^i(x_0)$, $i=0,1,\ldots,m+n$ s'exprime aussi comme
\[
  p^i(x) - (f \cdot q)^i(x) = 0, \quad i=0,1,\ldots,m+d,
\]
$n+1$ équations pour trouver $n+1 = (m+1) + d$ coefficients.

## Calcul de l'approximation Padé (2,1) de $e^x$ autour de $x=0$

- L'approximation $r(x)$ est
\[
  r(x) = \frac{p_0 + p_1x + p_2x^2}{1 + q_1x}.
\]
- Les coefficients $p_0$, $p_1$, $p_2$ et $q_1$ sont donnés par
\[
  \left. (p_0 + p_1x + p_2x^2) - e^x(1 + q_1x) \right|_{x=0} = p_0 - 1 = 0,
\]
\[
  \left. (p_1 + 2p_2x) - e^x (1 + q_1x) \right|_{x=0} = p_1 - 1 - q_1 = 0,
\]
\[
  \left. 2p_2 - e^x(1 + q_1x) - 2e^x q_1 \right|_{x=0} = 2p_2 - 1 - 2q_1 = 0,
\]
\[
  \left. -e^x(1 + q_1x) - 3e^x q_1 \right|_{x=0} = -1 - 3q_1 = 0.
\]
- La première équation donne $p_0 = 1$; la dernière, $q_1 = -\tfrac{1}{3}$.
- Ensuite, la deuxième équation donne $p_1 = 1 + q_1 = \tfrac{2}{3}$;
la troisième, $p_2 = \tfrac{1}{2} + q_1 = \tfrac{1}{6}$.

## Exemple I, Taylor et Padé, $f(x) = e^x$, $x_0 = 0$.

Approx. de Taylor (ordres 3, 4, 5, rouge), de Padé ((2,1), vert) :
```{r Taylor_Pade_exp}
source('Taylor_Pade_exp.R')
```

## Exemple I, erreurs d'approximation

```{r Taylor_Pade_exp_error}
source('Taylor_Pade_exp_error.R')
```

## Exemple II, Taylor et Padé, $f(x) = \log x$, $x_0 = 1$.

```{r Taylor_Pade_log}
source('Taylor_Pade_log.R')
```

## Exemple II, erreurs d'approximation

```{r Taylor_Pade_log_error}
source('Taylor_Pade_log_error.R')
```

## Approx. constante par morceaux et linéaire par morceaux

![](./Figures/const_lineaire.pdf)

## Polynômes de Bernstein d'ordre $n=10$

```{r Bernstein}
source('Bernstein.R')
```

## Approximation de Bernstein

- La région d'approximation est un intervalle fini $[a,b]$, normalisé
à $[0,1]$
- L'approximation d'ordre $n$ utilise les évaluations de $f$ sur une grille
$0,\frac{1}{n},\ldots,\frac{n-1}{n}$.
- L'approximation est
\[
  \sum_{i=0}^n f(\tfrac{i}{n}) b_{i,n}(x),
\]
où $b_{i,n}$ est le i-ième polynôme de Bernstein de degré $n$ :
\[
  b_{i,n}(x) = {n \choose i} x^i (1-x)^{n-i}.
\]

## Interpolation à la Hermite

Quatre fonctions cubiques sur l'intervalle $[0,1]$ :
\[
  \varphi_1(t) = 2t^3 - 3t^2 + 1, \quad \varphi_2(t) = t^3 - 2t^2 + t,
\]
\[
  \varphi_3(t) = -2t^3 + 3t^2, \quad \varphi_4(t) = t^3 - t^2.
\]

| Fonction $f$ | $f(0)$ | $f'(0)$ | $f(1)$ | $f'(1)$ |
|--------------|--------|---------|--------|---------|
| $\varphi_1$ | 1 | 0 | 0 | 0 |
| $\varphi_2$ | 0 | 1 | 0 | 0 |
| $\varphi_3$ | 0 | 0 | 1 | 0 |
| $\varphi_4$ | 0 | 0 | 0 | 1 |
| $a_1\varphi_1 + a_2\varphi_2 + a_3\varphi_3 + a_4\varphi_4$ | $a_1$ | $a_2$ | $a_3$ | $a_4$ |

## Graphique, cubiques de l'interpolation à la Hermite

```{r Hermite_4}
source('Hermite_piece.R')
```

## Notes, interpolation cubique à la Hermite

- Problème : interpoler une fonction avec la valeur et la dérivée spécifié à quelques points.
- Les intrants :
    - des points $x_1 < x_2 < \ldots < x_n$,
    - des valeurs $f(x_1),\ldots,f(x_n)$,
    - et les dérivées $f'(x_1),\ldots,f'(x_n)$.
- Le résultat : une fonction
    - cubique par morceaux $[x_i,x_{i+1}]$, (piecewise cubic function)
    - $C^1$ dans l'intervalle $[x_1, x_n]$,
    - ayant une deuxième dérivée discontinu à chaque $i$
- Il faut tranformer les fonctions $\varphi \colon [0,1] \to \mathbb{R}$ pour
avoir les fonctions $\varphi \colon [x_i, x_{i+1}]$.
- Il y a une version (rarement utilisée) avec 6 fonctions quintique $\varphi$
qui donne une fonction $C^2$ avec les valeurs, premières dérivées et deuxième
dérivées.